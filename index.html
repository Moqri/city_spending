<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<script>
  var city = parse('city')
  var city_metadata
  var url
  var columns
  $(document).ready(function() {
    $.ajax({
      url: "dict.json",
      type: "GET"
      }).done(function(data) {
        city_metadata = data[city]
        url = city_metadata.url
        columns = city_metadata.columns
        amount = columns.amount
        columns = $.map(columns, function(el) { return el }).join(',') 
        $.ajax({
          url: url,
          type: "GET",
          data: {
            "$limit" : 10,
            "$order" : amount+" DESC",
            "$$app_token" : "",
            "$select" : columns
          }
          }).done(function(data) {
            console.log(data);
          });
      });
  });


  function parse(val) {
      var result ,
          tmp = [];
      location.search
      .substr(1)
          .split("&")
          .forEach(function (item) {
          tmp = item.split("=");
          if (tmp[0] === val) result = decodeURIComponent(tmp[1]);
      });
      return result;
  }
</script>
